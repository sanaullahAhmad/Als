!function(e){e.fn.molpay=function(n){var t=e.extend({merchantID:null,orderID:null,amount:null,bill_name:null,bill_email:null,bill_mobile:null,bill_desc:null,country:null,returnURL:null,vcode:null,cur:null,langcode:null,debug:!1},n),d={min_amount:1.1,molpay_url:"https://www.onlinepayment.com.my/MOLPay/pay/",returnURL:location.href};t.debug&&(t.merchantID="molpaytech",t.orderID="DEMO1536",t.amount=1.1,t.country="MY",t.vcode="0d72ceec9ee3848f4721697f5dca166e",t.cur="MYR",t.langcode="en",console.info("Setting object : \n",t)),e.methods={isDebug:function(e,n){n="undefined"!=typeof n?n:"log",t.debug&&("log"==n?console.log(e):"time"==n?console.time(e):console.timeEnd(e))},validates:function(e,n){return null==e||e.length<1?(console.error(n),!1):!0},validate:function(){var n=!0;return n=n&&e.methods.validates(t.merchantID,"The merchant ID is required!"),n=n&&e.methods.validates(t.orderID,"The order ID is required!"),n=n&&e.methods.validates(t.amount,"The amount is required!"),n=n&&e.methods.validates(t.bill_name,"The bill name is required!"),n=n&&e.methods.validates(t.bill_email,"The bill email is required!"),n=n&&e.methods.validates(t.bill_desc,"The bill description is required!"),n=n&&e.methods.validates(t.vcode,"The Verfication code is required!"),n=n&&e.methods.validates(t.cur,"The currency is required!"),n=n&&e.methods.validates(t.returnURL,"The return URL is required!"),"MYR"===t.cur&&(n=n&&e.methods.amountvalidate(t.amount,"The amount must greater than "+t.cur+d.min_amount+"!")),n},amountvalidate:function(e,n){return e=parseFloat(e),e<d.min_amount?(console.error(n),!1):!0},makedialog:function(n){e.methods.isDebug("Create dialog element","time");var t='<div id="molpay-dialog-overlay"></div>';t+='<div id="molpay-dialog-box"><div>',t+=e.methods.generateiframe(),t+="</div></div>",t+=e.methods.generatehiddenfields(),n.append(t),n.css("overflow-y","hidden"),e("#molpay-dialog-overlay,#molpay-dialog-box").css("display","inline"),e.methods.isDebug("Create dialog element","end")},generateiframe:function(){var e=d.molpay_url+t.merchantID+"/?";return e+="amount="+t.amount+"&",e+="orderid="+t.orderID+"&",e+="bill_desc="+t.bill_desc+"&",e+="bill_name="+t.bill_name+"&",e+="bill_email="+t.bill_email+"&",e+="bill_mobile="+t.bill_mobile+"&",e+="vcode="+t.vcode+"&",e+="cur="+t.cur+"&",e+="langcode="+t.langcode+"&",e+="returnurl="+d.returnURL+"&",'<iframe id="molpayframe" frameborder="0" seemless src="'+e+'"></iframe>'},generatehiddenfields:function(){var e='<form id="molpayresubmitform" action="'+t.returnURL+'" method="POST">';return e+='<input type="hidden" name="amount" id="amount" />',e+='<input type="hidden" name="orderid" id="orderid" />',e+='<input type="hidden" name="appcode" id="appcode" />',e+='<input type="hidden" name="tranID" id="tranID" />',e+='<input type="hidden" name="domain" id="domain" />',e+='<input type="hidden" name="status" id="status" />',e+='<input type="hidden" name="error_code" id="error_code" />',e+='<input type="hidden" name="error_desc" id="error_desc" />',e+='<input type="hidden" name="currency" id="currency" />',e+='<input type="hidden" name="paydate" id="paydate" />',e+='<input type="hidden" name="channel" id="channel" />',e+='<input type="hidden" name="skey" id="skey" />',e+="</form>"}};var o=e.methods.validate();o&&e.methods.makedialog(this)}}(jQuery),molpay_is_return=function(e,n,t,d,o,i,a,l,r,m,u,c){$(document).ready(function(){window.top.document.getElementById("amount").value=e,window.top.document.getElementById("orderid").value=n,window.top.document.getElementById("appcode").value=t,window.top.document.getElementById("tranID").value=d,window.top.document.getElementById("domain").value=o,window.top.document.getElementById("status").value=i,window.top.document.getElementById("error_code").value=a,window.top.document.getElementById("error_desc").value=l,window.top.document.getElementById("currency").value=r,window.top.document.getElementById("paydate").value=m,window.top.document.getElementById("channel").value=u,window.top.document.getElementById("skey").value=c,parent.molpayCloseFrames()})},molpayCloseFrames=function(){jQuery("#molpayframe").remove(),jQuery("#molpayresubmitform").submit()};